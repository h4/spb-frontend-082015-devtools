/**
 * Core for Shower HTML presentation engine
 * shower-core v2.0.0, https://github.com/shower/core
 * @copyright 2010â€“2015 Vadim Makeev, http://pepelsbey.net/
 * @license MIT
 */
!function(a){var b,c={NOT_RESOLVED:"NOT_RESOLVED",IN_RESOLVING:"IN_RESOLVING",RESOLVED:"RESOLVED"},d=function(){var l={trackCircularDependencies:!0,allowMultipleDeclarations:!0},m={},n=!1,o=[],p=function(a,d,e){e||(e=d,d=[]);var f=m[a];f||(f=m[a]={name:a,decl:b}),f.decl={name:a,prev:f.decl,fn:e,state:c.NOT_RESOLVED,deps:d,dependents:[],exports:b}},q=function(b,c,d){"string"==typeof b&&(b=[b]),n||(n=!0,k(v)),o.push({deps:b,cb:function(b,f){f?(d||e)(f):c.apply(a,b)}})},r=function(a){var b=m[a];return b?c[b.decl.state]:"NOT_DEFINED"},s=function(a){return!!m[a]},t=function(a){for(var b in a)a.hasOwnProperty(b)&&(l[b]=a[b])},u=function(){var a,b={};for(var c in m)m.hasOwnProperty(c)&&(a=m[c],(b[a.decl.state]||(b[a.decl.state]=[])).push(c));return b},v=function(){n=!1,w()},w=function(){var a,b=o,c=0;for(o=[];a=b[c++];)x(null,a.deps,[],a.cb)},x=function(a,b,c,d){var e=b.length;e||d([]);for(var g,h,i=[],j=function(a,b){if(b)return void d(null,b);if(!--e){for(var c,f=[],g=0;c=i[g++];)f.push(c.exports);d(f)}},k=0,l=e;l>k;){if(g=b[k++],"string"==typeof g){if(!m[g])return void d(null,f(g,a));h=m[g].decl}else h=g;i.push(h),y(h,c,j)}},y=function(b,d,e){if(b.state===c.RESOLVED)return void e(b.exports);if(b.state===c.IN_RESOLVING)return void(l.trackCircularDependencies&&j(b,d)?e(null,g(b,d)):b.dependents.push(e));if(b.dependents.push(e),b.prev&&!l.allowMultipleDeclarations)return void A(b,i(b));l.trackCircularDependencies&&(d=d.slice()).push(b);var f=!1,k=b.prev?b.deps.concat([b.prev]):b.deps;b.state=c.IN_RESOLVING,x(b,k,d,function(c,d){return d?void A(b,d):(c.unshift(function(a,c){return f?void e(null,h(b)):(f=!0,void(c?A(b,c):z(b,a)))}),void b.fn.apply({name:b.name,deps:b.deps,global:a},c))})},z=function(a,d){a.exports=d,a.state=c.RESOLVED;for(var e,f=0;e=a.dependents[f++];)e(d);a.dependents=b},A=function(a,b){a.state=c.NOT_RESOLVED;for(var d,e=0;d=a.dependents[e++];)d(null,b);a.dependents=[]};return{create:d,define:p,require:q,getState:r,isDefined:s,setOptions:t,getStat:u}},e=function(a){k(function(){throw a})},f=function(a,b){return Error(b?'Module "'+b.name+'": can\'t resolve dependence "'+a+'"':'Required module "'+a+"\" can't be resolved")},g=function(a,b){for(var c,d=[],e=0;c=b[e++];)d.push(c.name);return d.push(a.name),Error('Circular dependence has been detected: "'+d.join(" -> ")+'"')},h=function(a){return Error('Declaration of module "'+a.name+'" has already been provided')},i=function(a){return Error('Multiple declarations of module "'+a.name+'" have been detected')},j=function(a,b){for(var c,d=0;c=b[d++];)if(a===c)return!0;return!1},k=function(){var b=[],c=function(a){return 1===b.push(a)},d=function(){var a=b,c=0,d=b.length;for(b=[];d>c;)a[c++]()};if("object"==typeof process&&process.nextTick)return function(a){c(a)&&process.nextTick(d)};if(a.setImmediate)return function(b){c(b)&&a.setImmediate(d)};if(a.postMessage&&!a.opera){var e=!0;if(a.attachEvent){var f=function(){e=!1};a.attachEvent("onmessage",f),a.postMessage("__checkAsync","*"),a.detachEvent("onmessage",f)}if(e){var g="__modules"+ +new Date,h=function(a){a.data===g&&(a.stopPropagation&&a.stopPropagation(),d())};return a.addEventListener?a.addEventListener("message",h,!0):a.attachEvent("onmessage",h),function(b){c(b)&&a.postMessage(g,"*")}}}var i=a.document;if("onreadystatechange"in i.createElement("script")){var j=i.getElementsByTagName("head")[0],k=function(){var a=i.createElement("script");a.onreadystatechange=function(){a.parentNode.removeChild(a),a=a.onreadystatechange=null,d()},j.appendChild(a)};return function(a){c(a)&&k()}}return function(a){c(a)&&setTimeout(d,0)}}();"object"==typeof exports?module.exports=d():a.modules=d()}("undefined"!=typeof window?window:global),modules.define("shower-next",["Emitter","util.extend","util.bind"],function(a,b,c,d){function e(a,c){c=c||{},this.events=new b,this._shower=a,this._elementsSelector=c.selector||".next",this._elements=[],this._innerComplete=0}var f="shower-timer";c(e.prototype,{init:function(){this._setupListeners(),-1!=this._shower.player.getCurrentSlideIndex()&&this._onSlideActivate()},destroy:function(){this._clearListeners(),this._elements=null,this._elementsSelector=null,this._innerComplete=null,this._shower=null},next:function(){if(!this._elements)throw new Error("Inner nav elements not found.");return this._innerComplete++,this._go(),this.events.emit("next"),this},prev:function(){return this._innerComplete--,this._go(),this.events.emit("prev"),this},getLength:function(){return this._elements=this._getElements(),this._elements.length},getComplete:function(){return this._innerComplete},_setupListeners:function(){var a=this._shower;this._showerListeners=a.events.group().on("destroy",this.destroy,this),this._playerListeners=a.player.events.group().on("activate",this._onSlideActivate,this).on("next",this._onNext,this).on("prev",this._onPrev,this);var b=a.plugins.get(f);b?this._setupTimerPluginListener(b):this._pluginsListeners=a.plugins.events.group().on("pluginadd",function(a){a.get("name")==f&&(this._setupTimerPluginListener(),this._pluginsListeners.offAll())},this)},_setupTimerPluginListener:function(a){a||(a=shower.plugins.get(f)),a.events.on("next",this._onNext,this,100)},_clearListeners:function(){this._showerListeners.offAll(),this._playerListeners.offAll()},_getElements:function(){var a=this._shower.player.getCurrentSlide().getLayout(),b=a.getElement();return b.querySelectorAll(this._elementsSelector)},_onNext:function(a){var b=this._elements.length;this._shower.container.isSlideMode()&&b&&this._innerComplete<b&&(a.preventDefault(),this.next())},_onPrev:function(a){var b=this._elements.length;this._shower.container.isSlideMode();b&&this._innerComplete<b&&this._innerComplete>0&&(a.preventDefault(),this.prev())},_go:function(){for(var a=0,b=this._elements.length;b>a;a++){var c=this._elements[a];a<this._innerComplete?c.classList.add("active"):c.classList.remove("active")}},_onSlideActivate:function(){this._elements=this._getElements(),this._elements=Array.prototype.slice.call(this._elements),this._innerComplete=this._getInnerComplete()},_getInnerComplete:function(){return this._elements.filter(function(a){return a.classList.contains("active")}).length}}),a(e)}),modules.require(["shower"],function(a){a.plugins.add("shower-next")}),modules.define("shower-progress",["util.extend"],function(a,b){function c(a,b){b=b||{},this._shower=a,this._playerListeners=null,this._element=null,this._elementSelector=b.selector||".progress"}b(c.prototype,{init:function(){var a=this._shower.container.getElement();this._element=a.querySelector(this._elementSelector),this._element&&(this._setupListeners(),this._element.setAttribute("role","progressbar"),this._element.setAttribute("aria-valuemin","0"),this._element.setAttribute("aria-valuemax","100"),this.updateProgress())},destroy:function(){this._clearListeners(),this._shower=null},updateProgress:function(){var a=this._shower.getSlidesCount(),b=this._shower.player.getCurrentSlideIndex(),c=100/(a-1)*b;this._element&&(this._element.style.width=c.toFixed(2)+"%",this._element.setAttribute("aria-valuenow",c.toFixed()),this._element.setAttribute("aria-valuetext","Slideshow Progress: "+c.toFixed()+"%"))},_setupListeners:function(){var a=this._shower;this._showerListeners=a.events.group().on("destroy",this.destroy,this),this._playerListeners=a.player.events.group().on("activate",this._onSlideChange,this)},_clearListeners:function(){this._showerListeners&&this._showerListeners.offAll(),this._playerListeners&&this._playerListeners.offAll()},_onSlideChange:function(){this.updateProgress()}}),a(c)}),modules.require(["shower"],function(a){a.plugins.add("shower-progress")}),modules.define("shower-timer",["Emitter","util.extend","util.bind"],function(a,b,c,d){function e(a){this.events=new b,this._shower=a,this._timer=null,this._showerListeners=null,this._playerListeners=null,this._pluginsListeners=null}var f="shower-next";c(e.prototype,{init:function(){this._setupListeners()},destroy:function(){this._clearTimer(),this._clearListeners(),this._shower=null},run:function(a){this._initTimer(a)},stop:function(){this._clearTimer()},_setupListeners:function(){var a=this._shower;this.events.on("next",this._onNext,this),this._showerListeners=a.events.group().on("destroy",this.destroy,this),this._playerListeners=a.player.events.group().on("keydown",this._clearTimer,this).on("activate",this._onSlideActivate,this),this._nextPlugin=a.plugins.get(f),this._nextPlugin||(this._pluginsListeners=a.plugins.events.group().on("pluginadd",function(b){b.get("name")==f&&(this._nextPlugin=a.plugins.get(f),this._pluginsListeners.offAll())},this)),-1!=a.player.getCurrentSlideIndex()&&this._onSlideActivate()},_clearListeners:function(){this._showerListeners.offAll(),this._playerListeners.offAll()},_onSlideActivate:function(){this._clearTimer();var a=this._shower.player.getCurrentSlide();if(this._shower.container.isSlideMode()&&a.state.visited<2){var b=a.getLayout().getData("timing");b&&/^(\d{1,2}:)?\d{1,3}$/.test(b)&&(-1!==b.indexOf(":")?(b=b.split(":"),b=1e3*(60*parseInt(b[0],10)+parseInt(b[1],10))):b=1e3*parseInt(b,10),0!==b&&this._initTimer(b))}},_initTimer:function(a){var b=(this._shower,this._nextPlugin);b&&b.getLength()&&b.getLength()!=b.getComplete()&&(a/=b.getLength()+1),this._timer=setInterval(d(function(){this.events.emit("next")},this),a)},_clearTimer:function(){this._timer&&(clearInterval(this._timer),this._timer=null)},_onNext:function(){this._clearTimer(),this._shower.next()}}),a(e)}),modules.require(["shower"],function(a){a.plugins.add("shower-timer")}),modules.define("shower-touch",["util.extend","util.bind"],function(a,b,c){function d(a,b){b=b||{},this._shower=a,this._gestures=b.gestures}var e=["VIDEO","AUDIO","A","BUTTON","INPUT"];b(d.prototype,{init:function(){this._setupListeners()},destroy:function(){this._clearListeners(),this._shower=null},_setupListeners:function(){var a=this._shower;this._showerListeners=a.events.group().on("destroy",this.destroy,this),this._bindedTouchStart=c(this._onTouchStart,this),this._bindedTouchMove=c(this._onTouchMove.bind,this),document.addEventListener("touchstart",this._bindedTouchStart,!1),document.addEventListener("touchmove",this._bindedTouchMove,!1)},_clearListeners:function(){this._showerListeners.offAll(),document.removeEventListener("touchstart",this._bindedTouchStart,!1),document.removeEventListener("touchmove",this._bindedTouchMove,!1)},_onTouchStart:function(a){var b,c=this._shower,d=c.container.isSlideMode(),e=a.target,f=this._getSlideByElement(e);f&&(d&&!this._isInteractiveElement(e)&&(b=a.touches[0].pageX,b>window.innerWidth/2?c.next():c.prev()),d||f.activate())},_onTouchMove:function(a){this._shower.container.isSlideMode()&&a.preventDefault()},_getSlideByElement:function(a){for(var b=this._shower.getSlidesArray(),c=null,d=0,e=b.length;e>d;d++)if(a.id==b[d].getId()){c=this._shower.get(d);break}return c},_isInteractiveElement:function(a){return e.some(function(b){return b==a.tagName})}}),a(d)}),modules.require(["shower"],function(a){a.plugins.add("shower-touch")}),function(){function a(){modules.require(["shower"],function(a){a.init(b,d)})}var b=".shower",c=["plugins","debug","slides","hotkeys"],d={};document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector(b),f=function(a){return e.dataset?e.dataset[a]:e.getAttribute("data-"+a)};if(!e)throw new Error("Shower element not found.");"false"!=f("auto")&&(window.hasOwnProperty("showerOptions")?d=window.showerOptions:c.forEach(function(a){var b=f(a);null!==b&&"undefined"!=typeof b&&(d[a]=b)}),a())},!1)}(),modules.define("Emitter",["emitter.Event","emitter.EventGroup","util.extend"],function(a,b,c,d){function e(a){a=a||{},this._context=a.context,this._parent=a.parent,this._listeners={}}function f(a,b){return a.priority-b.priority}d(e.prototype,{on:function(a,b,c,d){if(d=d||0,"string"==typeof a)this._addListener(a,b,c,d);else for(var e=0,f=a.length;f>e;e++)this._addListener(a[e],b,c,d);return this},off:function(a,b,c,d){if(d=d||0,"string"==typeof a)this._removeListener(a,b,c,d);else for(var e=0,f=a.length;f>e;e++)this._removeListener(a[e],b,c,d);return this},once:function(a,b,c,d){var e=function(f){this.off(a,e,this,d),c?b.call(c,f):b(f)};return this.on(a,e,this,d),this},emit:function(a,b){var c=b,d=this._listeners;c&&"function"==typeof c.get||(c=this.createEventObject(a,b,this._context)),c.isPropagationStopped()||(d.hasOwnProperty(a)&&this._callListeners(d[a],c),this._parent&&!c.isPropagationStopped()&&this._parent.emit(a,c))},createEventObject:function(a,c,e){var f={target:e,type:a};return new b(c?d(f,c):f)},setParent:function(a){this._parent!=a&&(this._parent=a)},getParent:function(){return this._parent},group:function(){return new c(this)},_addListener:function(a,b,c,d){var e={callback:b,context:c,priority:d};this._listeners[a]?this._listeners[a].push(e):this._listeners[a]=[e]},_removeListener:function(a,b,c,d){var e,f=this._listeners[a];if(f){for(var g=-1,h=0,i=f.length;i>h;h++)e=f[h],e.callback==b&&e.context==c&&e.priority==d&&(g=h);-1!=g&&(1==f.length?this._clearType(a):f.splice(g,1))}},_clearType:function(a){this._listeners.hasOwnProperty(a)&&delete this._listeners[a]},_callListeners:function(a,b){var c=a.length-1;for(a.sort(f);c>=0&&!b.defaultPrevented();){var d=a[c];d&&(d.context?d.callback.call(d.context,b):d.callback(b)),c--}}}),a(e)}),modules.define("emitter.Event",["util.extend"],function(a,b){function c(a){this._data=a,this._preventDefault=!1,this._stopPropagation=!1}b(c.prototype,{get:function(a){return this._data[a]},preventDefault:function(){return this._preventDefault=!0,this._preventDefault},defaultPrevented:function(){return this._preventDefault},stopPropagation:function(){return this._stopPropagation=!0,this._stopPropagation},isPropagationStopped:function(){return this._stopPropagation}}),a(c)}),modules.define("emitter.EventGroup",["util.extend"],function(a,b){function c(a){this.events=a,this._listeners=[]}b(c.prototype,{on:function(a,b,c){if(Array.isArray(a))for(var d=0,e=a.length;e>d;d++)this._listeners.push(a[d],b,c);else this._listeners.push(a,b,c);return this.events.on(a,b,c),this},off:function(a,b,c){if(Array.isArray(a))for(var d=0,e=a.length;e>d;d++)this._removeListener(a[d],b,c);else this._removeListener(a,b,c);return this},offAll:function(){for(var a=0,b=this._listeners.length;b>a;a+=3)this.events.off(this._listeners[a],this._listeners[a+1],this._listeners[a+2]);return this._listeners.length=0,this},_removeListener:function(a,b,c){for(var d=this._listeners.indexOf(a,0);-1!=d;)this._listeners[d+1]==b&&this._listeners[d+2]==c&&(this._listeners.splice(d,3),this.events.off(a,b,c)),d=this._listeners.indexOf(a,d)}}),a(c)}),modules.define("shower",["Emitter","shower.Container","shower.parser","shower.Player","shower.Location","shower.Plugins","util.extend"],function(a,b,c,d,e,f,g,h){function i(){this.events=new b,this.options={},this.plugins=new g(this),this.container=null,this.player=null,this._slides=[],this._isReady=!1,this._isHotkeysOn=!0,this._liveRegion=null}h(i.prototype,{init:function(a,b){return a=a||".shower",this.options=h({debug:!1,hotkeys:!0,slide:".shower > SECTION",parser:d,location:{slideMode:"full"},container:{mode:{full:"full",list:"list"}},plugins:{}},b),"string"==typeof a&&(a=document.querySelector(a)),this.container=new c(this,a),this.player=new e(this),this._parseSlides(),this._initLiveRegion(),this.options.debug&&(document.body.classList.add("debug"),console.log("Debug mode on")),this.options.hotkeys||this.disableHotkeys(),this._isReady=!0,this.location=new f(this),this.events.emit("ready"),this},destroy:function(){this.events.emit("destroy"),this.location.destroy(),this.container.destroy(),this.player.destroy(),this.plugins.destroy(),this._slides.length=0},ready:function(a){return a&&(this._isReady?a():this.events.once("ready",a)),this._isReady},add:function(a){if(Array.isArray(a))for(var b=0,c=a.length;c>b;b++)this._addSlide(a[b]);else this._addSlide(a);return this},remove:function(a){var b;if("number"==typeof a)b=a;else{if(-1==this._slides.indexOf(a))throw new Error("Slide not found");b=this._slides.indexOf(a)}return a=this._slides.splice(b,1)[0],this.events.emit("slideremove",{slide:a}),a.destroy(),this},get:function(a){return this._slides[a]},getSlidesArray:function(){return this._slides.slice()},getSlidesCount:function(){return this._slides.length},next:function(){return this.player.next(),this},prev:function(){return this.player.prev(),this},first:function(){return this.player.first(),this},last:function(){return this.player.last(),this},go:function(a){return this.player.go(a),this},disableHotkeys:function(){return this._isHotkeysOn=!1,this},enableHotkeys:function(){return this._isHotkeysOn=!0,this},isHotkeysEnabled:function(){return this._isHotkeysOn},getLiveRegion:function(){return this._liveRegion},updateLiveRegion:function(a){return this._liveRegion.innerHTML=a,this},_parseSlides:function(){var a=this.options.parser(this.container.getElement(),this.options.slide);this.add(a)},_addSlide:function(a){a.state.index=this._slides.length,this._slides.push(a),this.events.emit("slideadd",{slide:a})},_initLiveRegion:function(){var a=document.createElement("section");a.setAttribute("role","region"),a.setAttribute("aria-live","assertive"),a.setAttribute("aria-relevant","additions"),a.setAttribute("aria-label","Slide Content: Auto-updating"),a.className="region",document.body.appendChild(a),this._liveRegion=a}}),a(new i)}),modules.define("shower.Container",["Emitter","util.bind","util.extend"],function(a,b,c,d){function e(a,c){this.events=new b,this.options=a.options.container||{},this._shower=a,this._element=c,this._isSlideMode=!1,this.init()}d(e.prototype,{init:function(){var a=document.body.classList,b=this.options.mode;a.contains(b.list)||a.contains(b.full)||a.add(b.list),this._setupListeners()},destroy:function(){this._clearListeners(),this._element=null,this._shower=null,this._isSlideMode=null},getElement:function(){return this._element},enterSlideMode:function(){var a=document.body.classList,b=this.options.mode;return a.remove(b.list),a.add(b.full),this._applyTransform(this._getTransformScale()),this._isSlideMode||(this._isSlideMode=!0),this._isSlideMode=!0,this.events.emit("slidemodeenter"),this},exitSlideMode:function(){var a=document.body.classList,b=this.options.mode;return a.remove(b.full),a.add(b.list),this._applyTransform("none"),this._isSlideMode&&(this._isSlideMode=!1,this.scrollToSlide(this._shower.player.getCurrentSlideIndex())),this._isSlideMode=!1,this.events.emit("slidemodeexit"),this},isSlideMode:function(){return this._isSlideMode},scrollToSlide:function(a){var b,c=this._shower.get(a);if(!c)throw new Error("There is no slide with index "+a);return b=c.getLayout().getElement(),window.scrollTo(0,b.offsetTop),this},_setupListeners:function(){this._showerListeners=this._shower.events.group().on("slideadd",this._onSlideAdd,this).on("slideremove",this._onSlideRemove,this),this._shower.ready(c(this._onShowerReady,this)),window.addEventListener("resize",c(this._onResize,this)),document.addEventListener("keydown",c(this._onKeyDown,this))},_onShowerReady:function(){this._playerListeners=this._shower.player.events.group().on("activate",this._onSlideActivate,this)},_clearListeners:function(){this._showerListeners.offAll(),this._playerListeners&&this._playerListeners.offAll(),window.removeEventListener("resize",c(this._onResize,this)),document.removeEventListener("keydown",c(this._onKeyDown,this))},_getTransformScale:function(){var a=Math.max(document.body.clientWidth/window.innerWidth,document.body.clientHeight/window.innerHeight);return"scale("+1/a+")"},_applyTransform:function(a){["WebkitTransform","MozTransform","msTransform","OTransform","transform"].forEach(function(b){document.body.style[b]=a})},_onResize:function(){this.isSlideMode()&&this._applyTransform(this._getTransformScale())},_onSlideAdd:function(a){var b=a.get("slide");b.events.on("click",this._onSlideClick,this)},_onSlideRemove:function(a){var b=a.get("slide");b.events.off("click",this._onSlideClick,this)},_onSlideClick:function(){this._isSlideMode||this.enterSlideMode()},_onSlideActivate:function(a){var b=a.get("slide");this.scrollToSlide(b.state.index)},_onKeyDown:function(a){if(this._shower.isHotkeysEnabled())switch(a.which){case 13:a.preventDefault(),this.enterSlideMode();break;case 27:a.preventDefault(),this.exitSlideMode();break;case 116:if(a.preventDefault(),this.isSlideMode())this.exitSlideMode();else{var b=a.shiftKey?this._shower.player.getCurrentSlideIndex():0;this._shower.go(b),this.enterSlideMode()}break;case 80:!this.isSlideMode()&&a.altKey&&a.metaKey&&(a.preventDefault(),this.enterSlideMode())}}}),a(e)}),modules.define("shower.Location",["util.bind","util.extend"],function(a,b,c){function d(a){this._shower=a,this._showerListeners=null,this._playerListeners=null,this._documentTitle=document.title,this._popStateProcess=null,this.init()}c(d.prototype,{init:function(){this._setupListeners(),this._shower.ready()?(this._slideModeUrlParam=this._shower.options.location.slideMode,this._init()):this._shower.ready(b(this._init,this))},destroy:function(){this._clearListeners()},save:function(){var a=this._getCurrentState();window.history.pushState({slideMode:a.slideMode,slideId:a.slide&&a.slide.id},null,a.url)},_init:function(){var a,b=this._shower,c=window.location.hash.substr(1),d=0,e=document.body.classList,f=b.options.container.mode.full;window.location.hash="",""!==c&&(a=this._getSlideById(c),b.go("undefined"!=typeof a.index?a.index:d)),(this._isSlideMode()||e.contains(f))&&(b.player.getCurrentSlide()||b.go(0),b.container.enterSlideMode()),this._inited=!0},_getCurrentState:function(){var a=this._shower,b=a.player.getCurrentSlide(),c=a.container.isSlideMode(),d={slideMode:c};return b&&(d.slide={instance:b,id:b.getId()}),d.url=this._getCurrentURL(d),d},_getCurrentURL:function(a){var b=[window.location.pathname];return a.slideMode&&b.push("?"+this._slideModeUrlParam),a.slide&&b.push("#"+a.slide.id),b.join("")},_setupListeners:function(){var a=this._shower;this._playerListeners=a.player.events.group().on("activate",this._onSlideActivate,this),this._containerListener=a.container.events.group().on(["slidemodeenter","slidemodeexit"],this._onContainerSlideModeChange,this),window.addEventListener("popstate",b(this._onPopstate,this))},_clearListeners:function(){window.removeEventListener("popstate",b(this._onPopstate,this)),this._playerListeners.offAll(),this._containerListener.offAll()},_getSlideById:function(a){for(var b,c,d=this._shower.getSlidesArray(),e=d.length-1;e>=0;e--)if(d[e].getId()===a){b=d[e],c=e;break}return{slide:b,index:c}},_onSlideActivate:function(a){window.location.hash=a.get("slide").getId(),this._setTitle()},_onContainerSlideModeChange:function(){this._setTitle(),this._popStateProcess||"undefined"==typeof window.history.pushState||this.save()},_isSlideMode:function(a){var b,c,d;return!this._inited||a?(c=this._slideModeUrlParam,d=new RegExp("^"+c+".*"),b=d.test(window.location.search.substr(1))):b=this._shower.container.isSlideMode(),b},_onPopstate:function(){if(this._inited){this._popStateProcess=!0;var a,b=this._shower,c=b.container,d=window.location.hash.substr(1),e=b.player.getCurrentSlide(),f=b.player.getCurrentSlideIndex(),g=this._isSlideMode(!0);g&&-1===f?b.go(0):-1===f&&""!==window.location.hash&&b.go(0),e&&d!=e.getId()&&(a=this._getSlideById(d),b.go(a.index)),g?c.enterSlideMode():c.exitSlideMode(),this._popStateProcess=!1}},_setTitle:function(){var a=document.title,b=this._isSlideMode(),c=this._shower.player.getCurrentSlide();if(b&&c){var d=c.getTitle();d?document.title=d+" â€” "+this._documentTitle:document.title=this._documentTitle}else this._documentTitle!=a&&(document.title=this._documentTitle)}}),a(d)}),modules.define("shower.Player",["Emitter","util.bind","util.extend"],function(a,b,c,d){function e(a){this.events=new b,this._shower=a,this._currentSlideNumber=-1,this._currentSlide=null,this.init()}d(e.prototype,{init:function(){var a=this._shower;this._showerListeners=a.events.group().on("slideadd",this._onSlideAdd,this).on("slideremove",this._onSlideRemove,this),this._showerContainerListeners=a.container.events.group().on("slidemodeenter",this._onContainerSlideModeEnter,this),this._playerListeners=this.events.group().on("prev",this._onPrev,this).on("next",this._onNext,this),document.addEventListener("keydown",c(this._onKeyDown,this))},destroy:function(){this._showerListeners.offAll(),this._showerContainerListeners.offAll(),this._playerListeners.offAll(),document.removeEventListener("keydown",c(this._onKeyDown,this)),this._currentSlide=null,this._currentSlideNumber=null,this._shower=null},next:function(){return this.events.emit("next"),this},prev:function(){return this.events.emit("prev"),this},first:function(){return this.go(0),this},last:function(){return this.go(this._shower.getSlidesCount()-1),this},go:function(a){var b=this._shower.getSlidesCount(),c=this._currentSlide;return a!=this._currentSlideNumber&&b>a&&a>=0&&(c&&c.isActive()&&c.deactivate(),c=this._shower.get(a),this._currentSlide=c,this._currentSlideNumber=a,c.isActive()||c.activate(),this._shower.updateLiveRegion(c.getContent()),this.events.emit("activate",{index:a,slide:c})),this},getCurrentSlide:function(){return this._currentSlide},getCurrentSlideIndex:function(){return this._currentSlideNumber},_onPrev:function(){this._changeSlide(this._currentSlideNumber-1)},_onNext:function(){this._changeSlide(this._currentSlideNumber+1)},_changeSlide:function(a){this.go(a)},_onSlideAdd:function(a){var b=a.get("slide");b.events.on("activate",this._onSlideActivate,this)},_onSlideRemove:function(a){var b=a.get("slide");b.events.off("activate",this._onSlideActivate,this)},_onSlideActivate:function(a){var b=a.get("slide"),c=this._shower.getSlidesArray().indexOf(b);this.go(c)},_onKeyDown:function(a){if(this._shower.isHotkeysEnabled())switch(this.events.emit("keydown",{event:a}),a.which){case 33:case 38:case 37:case 72:case 75:if(a.altKey||a.ctrlKey||a.metaKey)return;a.preventDefault(),this.prev();break;case 34:case 40:case 39:case 76:case 74:if(a.altKey||a.ctrlKey||a.metaKey)return;a.preventDefault(),this.next();break;case 36:a.preventDefault(),this.first();break;case 35:a.preventDefault(),this.last();break;case 9:case 32:if(a.altKey||a.ctrlKey||a.metaKey)return;a.preventDefault(),a.shiftKey?this.prev():this.next()}},_onContainerSlideModeEnter:function(){this._currentSlide||this.go(0)}}),a(e)}),modules.define("shower.Plugins",["Emitter","util.bind","util.extend"],function(a,b,c,d){function e(a){this.events=new b,this._shower=a,this._isReady=!1,this._plugins={},this._waiting=[],this.init()}d(e.prototype,{init:function(){var a=this._shower;a.ready()?this._onShowerReady():a.events.once("ready",this._onShowerReady,this)},destroy:function(){this._plugins=null,this._waiting.length=0,this._shower=null},add:function(a,b){if(this._plugins[a])throw new Error("Plugin "+a+" already exist");var c={name:a,options:b};return this._requirePlugin(c),this},remove:function(a){if(!this._plugins[a])throw new Error("Plugin "+a+" not found");return delete this._plugins[a],this.events.emit("pluginremove",{name:a}),this},get:function(a){return this._plugins[a]},_addPlugin:function(a){this._isReady?this._instancePlugins(a):this._waiting.push(a)},_instancePlugins:function(a){var b=a.name,c=this._shower.options,d=a.options||c.plugins&&c.plugins[b],e=new a["class"](this._shower,d);this._plugins[b]=e,this.events.emit("pluginadd",{name:b}),this._isReady&&setTimeout(function(){e.init()},0)},_onShowerReady:function(){this._isReady=!0,this._waiting.length&&(this._waiting.forEach(this._instancePlugins,this),this._initPlugins())},_initPlugins:function(){var a=this._plugins;for(var b in a)a.hasOwnProperty(b)&&a[b].init()},_requirePlugin:function(a){modules.require([a.name],c(function(b){d(a,{"class":b}),this._addPlugin(a)},this))}}),a(e)}),modules.define("shower.parser",["Slide"],function(a,b){function c(a,c){var d=[],e=a.querySelectorAll(c);e=Array.prototype.slice.call(e);for(var f=0,g=e.length;g>f;f++){var h=e[f],i=new b(h);h.id||(h.id=f+1),d.push(i)}return d}a(c)}),modules.define("Slide",["Emitter","slide.Layout","slide.layoutFactory","util.extend"],function(a,b,c,d,e){function f(a,c,d){this.events=new b,this.options=c||{},this.state=e({visited:0,index:null}),this._content=a,this._isActive=!1,this._isVisited=!1,this.init()}e(f.prototype,{init:function(){this._layout="string"==typeof this._content?new d.createLayout({content:this._content}):new c(this._content),this._layout.setParent(this),this._setupListeners()},destroy:function(){this._clearListeners(),this._isActive=null,this.options=null,this._layout.destroy()},activate:function(){return this._isActive=!0,this.state.visited++,this.events.emit("activate",{slide:this}),this},deactivate:function(){return this._isActive=!1,this.events.emit("deactivate",{slide:this}),this},isActive:function(){return this._isActive},isVisited:function(){return this.state.visited>0},getLayout:function(){return this._layout},getTitle:function(){return this._layout.getTitle()},setTitle:function(a){return this._layout.setTitle(a),this},getId:function(){return this._layout.getElement().id},getContent:function(){return this._layout.getContent()},_setupListeners:function(){this._layoutListeners=this._layout.events.group().on("click",this._onSlideClick,this)},_clearListeners:function(){this._layoutListeners.offAll()},_onSlideClick:function(){this.activate(),this.events.emit("click",{slide:this})}}),a(f)}),modules.define("slide.Layout",["Emitter","util.bind","util.extend"],function(a,b,c,d){function e(a){this.events=new b,this._element=a,this._parent=null,this._parentElement=null,this.init()}var f={active:"active",visited:"visited"},g="H2";d(e.prototype,{init:function(){var a=this._element.parentNode;a?this._parentElement=a:this.setParentElement(a)},destroy:function(){this.setParent(null)},setParent:function(a){this._parent!=a&&(this._clearListeners(),this._parent=a,this._parent&&this._setupListeners(),this.events.emit("parentchange",{parent:a}))},getParent:function(){return this._parent},setParentElement:function(a){a!=this._parentElement&&(this._parentElement=a,a.appendChild(this._element),this.events.emit("parentelementchange",{parentElement:a}))},getParentElement:function(){return this._parentElement},getElement:function(){return this._element},setTitle:function(a){var b=this._element.querySelector(g);b?b.innerHTML=a:(b=document.createElement(g),b.innerHTML=a,this._element.insertBefore(b,this._element.firstChild))},getTitle:function(){var a=this._element.querySelector(g);return a?a.textContent:null},getData:function(a){var b=this._element;return b.dataset?b.dataset[a]:b.getAttribute("data-"+a)},getContent:function(){return this._element.innerHTML},_setupListeners:function(){this._slideListeners=this._parent.events.group().on("activate",this._onSlideActivate,this).on("deactivate",this._onSlideDeactivate,this),this._element.addEventListener("click",c(this._onSlideClick,this),!1)},_clearListeners:function(){this._slideListeners&&this._slideListeners.offAll(),this._element.removeEventListener("click",c(this._onSlideClick,this))},_onSlideActivate:function(){this._element.classList.add(f.active)},_onSlideDeactivate:function(){var a=this._element.classList;a.remove(f.active),a.add(f.visited)},_onSlideClick:function(){this.events.emit("click")}}),a(e)}),modules.define("slide.layoutFactory",["slide.Layout","util.extend"],function(a,b,c){var d={};c(d,{createLayout:function(a){a=a||{};var e=d._createElement(c({content:"",contentType:"slide"},a));return new b(e)},_createElement:function(a){var b=document.createElement("section");return b.innerHTML=a.content,b.classList.add(a.contentType),b}}),a(d)}),modules.define("util.bind",[],function(a){var b="function"==typeof Function.prototype.bind?function(a,b){return a.bind(b)}:function(a,b){return function(){return a.apply(b,arguments)}};a(b)}),modules.define("util.extend",function(a){function b(a){if(!a)throw new Error("util.extend: Target not found");
for(var b=1,c=arguments.length;c>b;b++){var d=arguments[b];for(var e in d)d.hasOwnProperty(e)&&(a[e]=d[e])}return a}a(b)});